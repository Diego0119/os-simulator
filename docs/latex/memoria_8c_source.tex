\doxysection{memoria.\+c}
\hypertarget{memoria_8c_source}{}\label{memoria_8c_source}\index{src/memoria.c@{src/memoria.c}}
\mbox{\hyperlink{memoria_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00010}00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{auxiliar_8h}{auxiliar.h}}"{}}\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00018}\mbox{\hyperlink{memoria_8c_a2f55ed34e9328798cb499cd78ca343c5}{00018}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_a2f55ed34e9328798cb499cd78ca343c5}{inicializar\_bloques\_memoria}}(\mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \textcolor{keywordtype}{int}\ cantidad\_bloques,\ \textcolor{keywordtype}{int}\ tamano\_bloque)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00019}00019\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ cantidad\_bloques;\ i++)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00031}00031\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00032}00032\ \ \ \ \ \ \ \ \ memoria[i].tamano\ =\ tamano\_bloque;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00033}00033\ \ \ \ \ \ \ \ \ memoria[i].estado\ =\ 1;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00034}00034\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00035}00035\ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00043}\mbox{\hyperlink{memoria_8c_a4481f3adeab9c9d90bd8e14cfde4b2bc}{00043}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_a4481f3adeab9c9d90bd8e14cfde4b2bc}{asignar\_memoria\_procesos}}(\mbox{\hyperlink{structCola}{Cola}}\ *cola,\ \mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \textcolor{keywordtype}{int}\ cantidad\_bloques)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00044}00044\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00055}00055\ \ \ \ \ \mbox{\hyperlink{structCola}{Cola}}\ *temp\_cola\ =\ malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structCola}{Cola}}));}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00056}00056\ \ \ \ \ temp\_cola\ =\ cola;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00057}00057\ \ \ \ \ \mbox{\hyperlink{structProceso}{Proceso}}\ *proceso\_extraido\ =\ malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structProceso}{Proceso}}));}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00058}00058\ \ \ \ \ \mbox{\hyperlink{structGantt}{Gantt}}\ diagrama\_gantt[\mbox{\hyperlink{memoria_8h_ab0f17287f3a9af76ef9109ec1dfce7a9}{MAX\_PROCESOS}}];}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00059}00059\ \ \ \ \ \textcolor{keywordtype}{int}\ indice\ =\ 0,\ tiempo\_global\ =\ 0;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{while}\ (temp\_cola-\/>front\ !=\ NULL)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00080}00080\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00081}00081\ \ \ \ \ \ \ \ \ proceso\_extraido\ =\ \mbox{\hyperlink{planificador_8c_a23a124840d5dd17458489403c6e0fca8}{dequeue}}(temp\_cola);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00082}00082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (proceso\_extraido\ ==\ NULL)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00083}00083\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stdout,\ \textcolor{stringliteral}{"{}No\ hay\ procesos\ en\ la\ cola\ para\ asignar\ memoria.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00086}00086\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00087}00087\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoria_8c_a7ce9e739e0384ca3be154758376ccfad}{manejar\_proceso}}(memoria,\ proceso\_extraido,\ cantidad\_bloques,\ diagrama\_gantt,\ \&tiempo\_global,\ \&indice);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00088}00088\ \ \ \ \ \ \ \ \ free(proceso\_extraido);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00089}00089\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00090}00090\ \ \ \ \ \mbox{\hyperlink{auxiliar_8c_a538bd84a9975c728e696aa3586475c8d}{imprimir\_gantt}}(diagrama\_gantt,\ indice);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00091}00091\ \ \ \ \ \mbox{\hyperlink{auxiliar_8c_ad55ebb88b181a48fad7400a82e6f9d90}{generar\_archivo\_gantt}}(diagrama\_gantt,\ indice,\ \textcolor{stringliteral}{"{}gantt.eps"{}});}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00092}00092\ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00103}\mbox{\hyperlink{memoria_8c_a7ce9e739e0384ca3be154758376ccfad}{00103}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_a7ce9e739e0384ca3be154758376ccfad}{manejar\_proceso}}(\mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \mbox{\hyperlink{structProceso}{Proceso}}\ *proceso\_extraido,\ \textcolor{keywordtype}{int}\ cantidad\_bloques,\ \mbox{\hyperlink{structGantt}{Gantt}}\ *diagrama\_gantt,\ \textcolor{keywordtype}{int}\ *tiempo\_global,\ \textcolor{keywordtype}{int}\ *indice)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00104}00104\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00127}00127\ \ \ \ \ \textcolor{keywordtype}{int}\ tiempo\_inicio\ =\ *tiempo\_global;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00128}00128\ \ \ \ \ \textcolor{keywordtype}{int}\ tamano\_proceso\ =\ proceso\_extraido-\/>memoria\_solicitada;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00129}00129\ \ \ \ \ \textcolor{keywordflow}{if}\ (tamano\_proceso\ >\ 2048)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00130}00130\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00131}00131\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}No\ hay\ suficiente\ memoria\ disponible\ para\ asignar\ al\ PROCESO\ \%d,\ pasando\ al\ siguiente\ PROCESO.\(\backslash\)n\(\backslash\)n"{}},\ proceso\_extraido-\/>pid);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00133}00133\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00134}00134\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ cantidad\_bloques\ \&\&\ tamano\_proceso\ >\ 0;\ i++)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00135}00135\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (memoria[i].estado\ ==\ 1)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00137}00137\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoria_8c_a73975f258bb6de8edd1bead26902db2c}{asignar\_bloque\_proceso}}(memoria,\ proceso\_extraido,\ \&tamano\_proceso,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00140}00140\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00141}00141\ \ \ \ \ *tiempo\_global\ +=\ proceso\_extraido-\/>tiempo\_rafaga;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00142}00142\ \ \ \ \ \mbox{\hyperlink{auxiliar_8c_af860b43b9483727416483393e9927a37}{registrar\_tiempos}}(diagrama\_gantt,\ proceso\_extraido-\/>pid,\ tiempo\_inicio,\ proceso\_extraido-\/>tiempo\_rafaga,\ indice);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00143}00143\ \ \ \ \ fprintf(stdout,\ \textcolor{stringliteral}{"{}Proceso\ \%d\ EJECUTADO\ EXITOSAMENTE.\(\backslash\)n\(\backslash\)n"{}},\ proceso\_extraido-\/>pid);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00144}00144\ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00153}\mbox{\hyperlink{memoria_8c_a73975f258bb6de8edd1bead26902db2c}{00153}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_a73975f258bb6de8edd1bead26902db2c}{asignar\_bloque\_proceso}}(\mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \mbox{\hyperlink{structProceso}{Proceso}}\ *proceso,\ \textcolor{keywordtype}{int}\ *tamano\_proceso,\ \textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00154}00154\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00178}00178\ \ \ \ \ \textcolor{keywordflow}{if}\ (memoria[i].tamano\ >=\ *tamano\_proceso)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00179}00179\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00180}00180\ \ \ \ \ \ \ \ \ fprintf(stdout,\ \textcolor{stringliteral}{"{}El\ proceso\ \%d\ usÃ³\ MEMORIA\ hasta\ el\ BLOQUE\ \%d\(\backslash\)n"{}},\ proceso-\/>pid,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00181}00181\ \ \ \ \ \ \ \ \ memoria[i].tamano\ -\/=\ *tamano\_proceso;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00182}00182\ \ \ \ \ \ \ \ \ memoria[i].estado\ =\ 0;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00183}00183\ \ \ \ \ \ \ \ \ *tamano\_proceso\ =\ 0;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00184}00184\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoria_8c_a92cf0b92cd8f5a979d4674eb24e76826}{verificar\_fragmentacion}}(memoria,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00185}00185\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoria_8c_af4ac314829b646f3a82e421ebfb7f3ce}{ejecutar\_proceso}}(memoria,\ proceso,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00186}00186\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00187}00187\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00188}00188\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00189}00189\ \ \ \ \ \ \ \ \ *tamano\_proceso\ -\/=\ memoria[i].tamano;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00190}00190\ \ \ \ \ \ \ \ \ memoria[i].tamano\ =\ 0;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00191}00191\ \ \ \ \ \ \ \ \ memoria[i].estado\ =\ 0;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00192}00192\ \ \ \ \ \ \ \ \ fprintf(stdout,\ \textcolor{stringliteral}{"{}Proceso\ \%d\ en\ EJECUCIÃN,\ bloque\ (\%d)\(\backslash\)n"{}},\ proceso-\/>pid,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00193}00193\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoria_8c_af4ac314829b646f3a82e421ebfb7f3ce}{ejecutar\_proceso}}(memoria,\ proceso,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00194}00194\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memoria_8c_a92cf0b92cd8f5a979d4674eb24e76826}{verificar\_fragmentacion}}(memoria,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00195}00195\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00196}00196\ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00203}\mbox{\hyperlink{memoria_8c_a92cf0b92cd8f5a979d4674eb24e76826}{00203}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_a92cf0b92cd8f5a979d4674eb24e76826}{verificar\_fragmentacion}}(\mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \textcolor{keywordtype}{int}\ i)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00204}00204\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00213}00213\ \ \ \ \ \textcolor{keywordtype}{int}\ fragmentacion\_interna\ =\ memoria[i].tamano;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00214}00214\ \ \ \ \ \textcolor{keywordflow}{if}\ (fragmentacion\_interna\ >\ 0)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00215}00215\ \ \ \ \ \ \ \ \ fprintf(stdout,\ \textcolor{stringliteral}{"{}FRAGMENTACIÃN\ INTERNA:\ \%d\ KB\ en\ el\ BLOQUE\ \%d\(\backslash\)n"{}},\ fragmentacion\_interna,\ i);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00216}00216\ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00224}\mbox{\hyperlink{memoria_8c_af4ac314829b646f3a82e421ebfb7f3ce}{00224}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_af4ac314829b646f3a82e421ebfb7f3ce}{ejecutar\_proceso}}(\mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \mbox{\hyperlink{structProceso}{Proceso}}\ *proceso,\ \textcolor{keywordtype}{int}\ posicion)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00225}00225\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00233}00233\ \ \ \ \ sleep(proceso-\/>tiempo\_rafaga);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00234}00234\ \ \ \ \ \mbox{\hyperlink{memoria_8c_ae479e3e0b8af7a21fb85def133295379}{liberar\_memoria}}(memoria,\ posicion);}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00235}00235\ \}}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00242}\mbox{\hyperlink{memoria_8c_ae479e3e0b8af7a21fb85def133295379}{00242}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{memoria_8c_ae479e3e0b8af7a21fb85def133295379}{liberar\_memoria}}(\mbox{\hyperlink{structBloqueMemoria}{BloqueMemoria}}\ *memoria,\ \textcolor{keywordtype}{int}\ posicion)}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00243}00243\ \{}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00251}00251\ \ \ \ \ memoria[posicion].estado\ =\ 1;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00252}00252\ \ \ \ \ memoria[posicion].tamano\ =\ 128;}
\DoxyCodeLine{\Hypertarget{memoria_8c_source_l00253}00253\ \}}

\end{DoxyCode}
